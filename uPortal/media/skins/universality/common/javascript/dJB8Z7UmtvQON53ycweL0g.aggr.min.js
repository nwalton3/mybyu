"use strict";var up=up||{};(function(b,a){up.defaultNodeIdExtractor=function(c){return b(c).attr("id").split("_")[1];};up.getStringPropertySortFunction=function(c,d){return function(f,e){var h=f[c].toLowerCase();var g=e[c].toLowerCase();if(h===g){return 0;}if(d){d=d.toLowerCase();if(h===d){return -1;}else{if(g===d){return 1;}}}if(h>g){return 1;}else{return -1;}};};up.escapeSpecialChars=function(d){var c=new RegExp("[.*+?|()\\[\\]{}\\\\]","g");return d.replace(c,"\\$&");};up.refreshPager=function(c,e){var d=a.copy(c.model);d.totalRange=e.length;d.pageIndex=0;d.pageCount=Math.max(1,Math.floor((d.totalRange-1)/d.pageSize)+1);a.clear(c.options.dataModel);a.model.copyModel(c.options.dataModel,e);c.permutation=undefined;c.events.onModelChange.fire(d,c.model,c);a.model.copyModel(c.model,d);};up.showLoader=function(c){c.show();};up.hideLoader=function(c,f){var d,e;e=(f===undefined)?1000:f;d=setTimeout(function(){c.fadeOut("slow");clearTimeout(d);},e);};up.formatMessage=function(g,c){var f=g;for(var d=0;d<c.length;d++){var e=new RegExp("\\{"+d+"\\}","gm");f=f.replace(e,c[d]);}return f;};})(jQuery,fluid);
"use strict";var up=up||{};(function(d,a){var c=function(g){return{id:g.id,description:g.description,fname:g.fname,title:g.title,name:g.name,state:g.state,type:g.typeId,iconUrl:g.iconUrl};};var b=function(g){return{id:g.id,name:g.name,description:g.description,categories:[],deepCategories:[],portlets:[],deepPortlets:[]};};var f=function(h,g){if(!h.state.categories[g.id]){var i=new b(g);d(g.categories).each(function(j,k){k=f(h,k);i.categories.push(k);i.categories[k.id]=i.categories[i.categories.length-1];if(!i.deepCategories[k.id]){i.deepCategories.push(k);i.deepCategories[k.id]=i.deepCategories[i.deepCategories.length-1];}d(k.deepCategories).each(function(l,m){if(!i.deepCategories[m.id]){i.deepCategories.push(m);i.deepCategories[m.id]=i.deepCategories[i.deepCategories.length-1];}});d(k.deepPortlets).each(function(l,m){if(!i.deepPortlets["portlet."+m.id]){i.deepPortlets.push(m);i.deepPortlets["portlet."+m.id]=i.deepPortlets[i.deepPortlets.length-1];}});});d(g.channels).each(function(j,k){var l=new c(k);i.portlets.push(l);i.portlets["portlet."+l.id]=i.portlets[i.portlets.length-1];if(!h.state.portlets["portlet."+l.id]){h.state.portlets.push(l);h.state.portlets["portlet."+l.id]=h.state.portlets[h.state.portlets.length-1];}if(!i.deepPortlets["portlet."+l.id]){i.deepPortlets.push(l);i.deepPortlets["portlet."+l.id]=h.state.portlets[i.deepPortlets.length-1];}});h.state.categories.push(i);h.state.categories[i.id]=h.state.categories[h.state.categories.length-1];return i;}else{return h.state.categories[g.id];}};var e=function(g){d.ajax({url:g.options.portletListUrl,success:function(h){g.state=g.state||{};g.state.portlets=[];g.state.categories=[];d(h.registry.categories).each(function(i,j){f(g,j);});if(h.registry.channels.length>0){f(g,{id:"uncat",name:"Uncategorized",description:"Uncategorized Channels",categories:[],channels:h.registry.channels});}g.events.onLoad.fire();},dataType:"json"});};up.PortletRegistry=function(g,h){var i=a.initView("up.PortletRegistry",g,h);i.refreshRegistry=function(){e(i);};i.getPortlet=function(j){return i.state.portlets["portlet."+j];};i.getCategory=function(j){return i.state.categories[j];};i.getMemberPortlets=function(j,k){return k?i.state.categories[j].deepPortlets:i.state.categories[j].portlets;};i.getMemberCategories=function(j,k){return k?i.state.categories[j].deepCategories:i.state.categories[j].categories;};i.getAllCategories=function(){return i.state.categories;};i.getAllPortlets=function(){return i.state.portlets;};e(i);return i;};a.defaults("up.PortletRegistry",{portletListUrl:null,allCategoriesName:"All",events:{onLoad:null},listeners:{onLoad:null}});})(jQuery,fluid);
"use strict";var up=up||{};(function(b,a){up.EntityRegistry=function(c,d){var e=a.initView("up.EntityRegistry",c,d);e.state=e.state||{};e.state.entityCache=new Array();e.searchEntities=function(i,f){var g,h;g=e.options.entitiesUrl+".json";b.ajax({async:false,url:g,type:"GET",dataType:"json",data:{entityType:i,q:f},success:function(j){h=j.jsonEntityBeanList;}});return h;};e.getEntity=function(j,i){var f,h,g;f=j+":"+i;if(e.state.entityCache[f]){g=e.state.entityCache[f];}h=e.options.entitiesUrl+"/"+j+"/"+i+".json";b.ajax({async:false,url:h,type:"GET",dataType:"json",success:function(k){e.state.entityCache[f]=k.jsonEntityBean;g=k.jsonEntityBean;}});return g;};return e;};a.defaults("up.EntityRegistry",{entitiesUrl:"/uPortal/api/entities"});})(jQuery,fluid);
"use strict";var up=up||{};(function(c,b){up.DefaultPortletSearchView=function(e,i,g){var h,f,d;h=b.initView("up.DefaultPortletSearchView",e,g);h.state={};f=[{id:"searchForm",selector:h.options.selectors.searchForm},{id:"searchInput",selector:h.options.selectors.searchInput}];d={children:[{ID:"searchForm",decorators:[{type:"jQuery",func:"submit",args:function(){i.events.onPortletSearch.fire(i,h.locate("searchInput").val(),true);return false;}}]},{ID:"searchInput",value:h.options.searchInvitationMessage,decorators:[{type:"jQuery",func:"keyup",args:function(){i.events.onPortletSearch.fire(i,c(this).val(),false);}},{type:"jQuery",func:"focus",args:function(){if(c(this).val()===h.options.searchInvitationMessage){c(this).val("");}}},{type:"jQuery",func:"blur",args:function(){var j;j=c.trim(c(this).val());if(j===""){c(this).val(h.options.searchInvitationMessage);}}}]}]};h.state.templates=b.selfRender(h.locate("portletSearchView"),d,{cutpoints:f});return h;};b.defaults("up.DefaultPortletSearchView",{searchInvitationMessage:"Search for stuff",selectors:{portletSearchView:".portlet-search-view",searchForm:".portlet-search-form",searchInput:".portlet-search-input"}});up.PortletBrowser=function(d,g,e){var f=b.initView("up.PortletBrowser",d,e);f.options.portletRegistry.options=f.options.portletRegistry.options||{};f.options.portletRegistry.options.listeners=f.options.portletRegistry.options.listeners||{};f.options.portletRegistry.options.listeners.onLoad=function(){a(f,g,d);};f.registry=b.initSubcomponent(f,"portletRegistry",[d,b.COMPONENT_OPTIONS]);return f;};var a=function(e,f,d){e.state={};e.categoryListView=b.initSubcomponent(e,"categoryListView",[d,e,b.COMPONENT_OPTIONS]);e.searchView=b.initSubcomponent(e,"searchView",[d,e,b.COMPONENT_OPTIONS]);e.portletListView=b.initSubcomponent(e,"portletListView",[d,e,b.COMPONENT_OPTIONS]);e.events.onLoad.fire(e,f);};b.defaults("up.PortletBrowser",{portletRegistry:{type:"up.PortletRegistry"},searchView:{type:"up.DefaultPortletSearchView"},events:{onLoad:null,onCategorySelect:null,onPortletSearch:null,onPortletSelect:null,onPortletDrag:null},listeners:{onLoad:null,onCategorySelect:function(e,d){e.state.currentCategory=d.id;e.categoryListView.refresh();e.portletListView.refresh();},onPortletSearch:function(f,e,d){e=c.trim(e);f.state.portletRegex=e.length>0?new RegExp(up.escapeSpecialChars(e),"i"):undefined;f.portletListView.refresh();},onPortletSelect:function(d,e){d.portletListView.refresh();},onPortletDrag:null}});})(jQuery,fluid);
"use strict";var up=up||{};(function(e,c){var d=function(i,h){var j;if(i.find(h).length>0){j=true;}else{j=false;}return j;};var b=function(m,n){var l,h,j,i,k,o;l=e(n);h=l.find(m.options.selectors.portlet);o=e(m.elem.pseudoDropTargetMarkUp);if(h.length>0){j=l.find(m.options.selectors.lastPortletLocked);if(j.length>0){o.insertAfter(j);}else{i=l.find(m.options.selectors.firstPortletMovable);o.insertBefore(i);}}else{k=l.children();if(k.length>0){o.insertAfter(k.get((k.length-1)));}else{l.prepend(o);}}o.show();};var g=function(i,j){var h,k;h=e(j);k=h.find(i.options.selectors.pseudoDropTarget);k.remove();};var f=function(l,m){var o,k,q,n,i,p,j,h;o=l.elem.loader;k=e(m);i=k.find(l.options.selectors.pseudoDropTarget);o.css({margin:"7px 0 0 0",opacity:".70","background-color":"#000"});up.showLoader(o);i.addClass(l.options.styles.targetDropped);q=d(k,l.options.selectors.portlet);if(q){n=d(k,l.options.selectors.portletMovable);if(n){p=i.prev(l.options.selectors.portlet+":first");if(p.length>0){j=up.defaultNodeIdExtractor(p[0]);h=l.options.appendAfter;}else{p=i.next(l.options.selectors.portlet+":first");j=up.defaultNodeIdExtractor(p[0]);h=l.options.insertBefore;}}else{j=up.defaultNodeIdExtractor(m);h=l.options.appendAfter;}}else{j=up.defaultNodeIdExtractor(m);h=l.options.appendAfter;}l.events.onDropTarget.fire(h,j);};var a=function(h){h.elem={};h.elem.columnContainer=e(h.options.selectors.body).find(h.options.selectors.columnContainer);h.elem.pseudoDropTargetMarkUp='<div class="'+h.options.styles.pseudoDropTarget+'"><span>'+h.options.pseudoDropTargetLabel+"</span></div>";h.elem.loader=e(h.options.selectors.loader);};up.LayoutDraggableManager=function(h,i){var j;j=c.initView("up.LayoutDraggableManager",h,i);j.enableEligibleColumns=function(m,n){var k,l;k=j.elem.columnContainer.find(j.options.selectors.canAddChildren);l=k.find(j.options.selectors.innerColumn);j.makeDroppable(l);};j.makeDroppable=function(k){k.droppable({accept:j.options.selectors.accept,over:function(l,m){b(j,l.target);},out:function(l,m){g(j,l.target);},drop:function(l,m){f(j,l.target);}});};j.makeDraggable=function(l){var k;k=l.find(j.options.selectors.dragHandle);l.draggable({handle:k,appendTo:j.options.selectors.body,iframeFix:j.options.iframeFix,opacity:j.options.opacity,helper:j.options.helper,revert:j.options.revert,cursor:j.options.cursor,cursorAt:j.options.cursorAt,stack:j.options.stack,tolerance:j.options.tolerance,containment:j.options.selectors.body,start:function(m,n){j.enableEligibleColumns(m,n);}});};j.initDragAndDrop=function(m,o,l){var k,n;k=l.container.find(j.options.selectors.galleryList);if(k.attr("id")!==j.options.useContentPortletListID){n=k.find("li");j.makeDraggable(n);}};a(j);return j;};c.defaults("up.LayoutDraggableManager",{selectors:{body:"#portal",galleryList:".portlet-list",columnContainer:"#portalPageBodyColumns",column:".portal-page-column",innerColumn:".portal-page-column-inner",dragHandle:".portlet-thumb-gripper",pseudoDropTarget:".layout-draggable-drop-target",loader:"#galleryLoader",accept:".portlet",canAddChildren:".canAddChildren",portlet:"div[id*=portlet_]",lastPortletLocked:"div[id*=portlet_].locked:last",firstPortletMovable:"div[id*=portlet_].movable:first",portletMovable:"div[id*=portlet_].movable"},styles:{pseudoDropTarget:"layout-draggable-drop-target",targetDropped:"layout-draggable-target-dropped",canAddChildren:"canAddChildren"},events:{onDropTarget:null},pseudoDropTargetLabel:"Drop Here",iframeFix:true,opacity:".80",helper:"clone",revert:"invalid",cursor:"move",cursorAt:{top:10,left:12},stack:".ui-draggable-dragging",tolerance:"intersect",insertBefore:"insertBefore",appendAfter:"appendAfter",nbsp:"&nbsp;",useContentPortletListID:"useContentPortletList"});})(jQuery,fluid);
"use strict";var up=up||{};(function(b,a){up.AjaxLayoutCategoryListView=function(c,g,e){var f=a.initView("up.AjaxLayoutCategoryListView",c,e);f.state={};var d=[{id:"~categoryContainer:",selector:".category-choice-container"},{id:"category",selector:".category-choice"},{id:"categoryLink",selector:".category-choice-link"},{id:"categoryName",selector:".category-choice-name"}];f.refresh=function(){var i=[];i.push({id:"",name:f.options.rootCategoryName,description:f.options.rootCategoryDescription,categories:[],deepCategories:[],portlets:[],deepPortlets:[]});b(g.registry.getAllCategories()).each(function(k,l){if(l.deepPortlets.length>0&&l.id!=="local.1"){i.push(l);}});i.sort(up.getStringPropertySortFunction("name",f.options.rootCategoryName));var h={children:[]};var j=g.state.currentCategory||"";b(i).each(function(k,l){h.children.push({ID:"categoryContainer:",children:[{ID:"category",decorators:[{type:"addClass",classes:l.id===j?"active":""}]},{ID:"categoryLink",decorators:[{type:"jQuery",func:"click",args:function(){g.events.onCategorySelect.fire(g,l);}}]},{ID:"categoryName",value:l.name}]});});if(f.state.templates){a.reRender(f.state.templates,b(c).find(".categories"),h,{cutpoints:d});}else{f.state.templates=a.selfRender(b(c).find(".categories"),h,{cutpoints:d});}};f.refresh();return f;};a.defaults("up.AjaxLayoutCategoryListView",{rootCategoryName:"ALL",rootCategoryDescription:"All Categories"});up.AjaxLayoutPortletListView=function(c,g,e){var f,d;f=a.initView("up.AjaxLayoutPortletListView",c,e);f.dragManager=a.initSubcomponent(f,"dragManager",[f.container,a.COMPONENT_OPTIONS]);f.dragManager.events.onDropTarget.addListener(function(i,h){f.state.drag.overall.events.onPortletDrag.fire(f.state.drag.data,i,h);});f.state={};d=[{id:"portlet:",selector:".portlet"},{id:"portletWrapper",selector:".portlet-wrapper"},{id:"portletLink",selector:".portlet-thumb-link"},{id:"portletTitle",selector:".portlet-thumb-titlebar"},{id:"portletDescription",selector:".portlet-thumb-description"},{id:"portletIcon",selector:".portlet-thumb-icon"}];f.refresh=function(){var i,h;i=[];h=(g.state.currentCategory&&g.state.currentCategory!=="")?g.registry.getMemberPortlets(g.state.currentCategory,true):g.registry.getAllPortlets();b(h).each(function(l,m){if(!g.state.portletRegex||g.state.portletRegex.test(m.title)||g.state.portletRegex.test(m.name)||g.state.portletRegex.test(m.fname)||g.state.portletRegex.test(m.description)){if(!m.iconUrl){m.iconUrl=f.options.defaultIconUrl;}i.push(m);}});i.sort(up.getStringPropertySortFunction("title"));if(f.state.pager){up.refreshPager(f.state.pager,i);}else{var k=[{key:"portletWrapper",valuebinding:"*.id",components:function(l){return{decorators:[{type:"jQuery",func:"mousedown",args:function(){f.state.drag={overall:g,data:l};}}]};}},{key:"portletLink",valuebinding:"*.id",components:function(l){return{decorators:[{type:"jQuery",func:"click",args:function(){g.events.onPortletSelect.fire(g,l);}}]};}},{key:"portletTitle",valuebinding:"*.title"},{key:"portletDescription",valuebinding:"*.description"},{key:"portletIcon",valuebinding:"*.id",components:function(l){return{decorators:[{type:"attrs",attributes:{style:"background: url("+l.iconUrl+") top left no-repeat;"}}]};}}];var j={dataModel:i,annotateColumnRange:"portletTitle",columnDefs:k,bodyRenderer:{type:"fluid.pager.selfRender",options:{selectors:{root:".portlet-list"},row:"portlet:",renderOptions:{cutpoints:d}}},pagerBar:{type:"fluid.pager.pagerBar",options:{pageList:{type:"fluid.pager.renderedPageList",options:{linkBody:"a"}}}}};f.state.pager=a.pager(b(c).find(".portlet-results"),j);f.state.pager.events.onModelChange.addListener(f.dragManager.initDragAndDrop);f.state.pager.events.initiatePageSizeChange.fire(f.options.pageSize);}};f.refresh();return f;};a.defaults("up.AjaxLayoutPortletListView",{dragManager:{type:"up.LayoutDraggableManager"},selectors:{galleryList:".portlet-list"},pageSize:6,defaultIconUrl:"/ResourceServingWebapp/rs/tango/0.8.90/32x32/categories/applications-other.png"});up.BrowseContentPane=function(c,f,d){var e=a.initView("up.BrowseContentPane",c,d);var g=false;e.showPane=function(){if(!g){f.showLoading();g=true;e.portletBrowser=a.initSubcomponent(e,"portletBrowser",[e.locate("pane"),f,a.COMPONENT_OPTIONS]);}e.locate("pane").show();e.locate("paneLink").addClass("active");e.events.onShow.fire(e);};e.hidePane=function(){e.locate("pane").hide();e.locate("paneLink").removeClass("active");};e.showLoading=function(){e.locate("ui").hide();e.locate("loading").show();};e.hideLoading=function(){e.locate("loading").hide();e.locate("ui").show();};e.showPortletList=function(){e.locate("portletList").show();e.locate("fragmentList").hide();e.locate("fragmentMenuDetail").slideUp(300,function(){e.locate("portletMenu").addClass("active");e.locate("fragmentMenu").removeClass("active");e.locate("portletMenuDetail").slideDown(300);});};e.showFragmentList=function(){e.locate("portletList").hide();e.locate("fragmentList").show();e.locate("portletMenuDetail").slideUp(300,function(){e.locate("portletMenu").removeClass("active");e.locate("fragmentMenu").addClass("active");e.locate("fragmentMenuDetail").slideDown(300);});if(!e.fragmentBrowser){e.showLoading();e.fragmentBrowser=a.initSubcomponent(e,"fragmentBrowser",[e.locate("pane"),a.COMPONENT_OPTIONS]);e.hideLoading();}};e.locate("paneLink").click(function(){f.showPane(e.options.key);});e.locate("portletListLink").click(e.showPortletList);e.locate("fragmentListLink").click(e.showFragmentList);return e;};a.defaults("up.BrowseContentPane",{portletBrowser:{type:"up.PortletBrowser",options:{portletRegistry:{options:{portletListUrl:"channel-list.js"}},categoryListView:{type:"up.AjaxLayoutCategoryListView"},portletListView:{type:"up.AjaxLayoutPortletListView"},listeners:{onLoad:function(d,c){c.hideLoading();}}}},fragmentBrowser:{type:"up.FragmentBrowser",options:{fragmentServiceUrl:"tab-list.js"}},key:"add-content",selectors:{pane:".add-content",paneLink:".add-content-link",ui:".content-results-wrapper",loading:".content-loading",portletMenu:".add-content .categories-column",portletMenuDetail:".add-content .categories-wrapper",portletListLink:".add-content .portlet-list-link",portletList:".add-content .portlet-results",fragmentMenu:".packages-column",fragmentMenuDetail:".packages-wrapper",fragmentListLink:".package-list-link",fragmentList:".package-results"},events:{onInitialize:null,onShow:null},listeners:{onInitialize:null,onShow:null}});up.PortalGalleryPane=function(c,f,d){var e,g;e=a.initView("up.PortalGalleryPane",c,d);g=false;e.showPane=function(){if(!g){f.showLoading();e.events.onInitialize.fire(e);g=true;f.hideLoading();}e.locate("pane").show();e.locate("paneLink").addClass("active");e.events.onShow.fire(e);};e.hidePane=function(){e.locate("pane").hide();e.locate("paneLink").removeClass("active");};e.locate("paneLink").click(function(){f.showPane(e.options.key);});return e;};a.defaults("up.PortalGalleryPane",{key:null,selectors:{pane:null,paneLink:null},events:{onInitialize:null,onShow:null},listeners:{onInitialize:null,onShow:null}});up.PortalGallery=function(c,d){var e=a.initView("up.PortalGallery",c,d);e.panes=[];e.panes.push(a.initSubcomponent(e,"browseContentPane",[c,e,a.COMPONENT_OPTIONS]));e.panes.push(a.initSubcomponent(e,"useContentPane",[c,e,a.COMPONENT_OPTIONS]));e.panes.push(a.initSubcomponent(e,"skinPane",[c,e,a.COMPONENT_OPTIONS]));e.panes.push(a.initSubcomponent(e,"layoutPane",[c,e,a.COMPONENT_OPTIONS]));e.openGallery=function(){e.options.isOpen=true;e.locate("galleryHandle").addClass("handle-arrow-up");e.locate("galleryInner").slideDown(e.options.openSpeed);e.showPane("add-content");};e.closeGallery=function(){e.options.isOpen=false;e.locate("galleryHandle").removeClass("handle-arrow-up");e.locate("galleryInner").slideUp(e.options.closeSpeed);};e.showPane=function(f){b(e.panes).each(function(g,h){if(h.options.key===f){h.showPane();}else{h.hidePane();}});};e.showLoading=function(){e.locate("ui").hide();e.locate("loading").show();};e.hideLoading=function(){var g,h,f;g=e.locate("loading");h=e.locate("ui");h.show();g.fadeOut("slow");};e.locate("galleryHandle").click(function(){if(e.options.isOpen){e.closeGallery();}else{e.openGallery();}});e.locate("closeLink").click(e.closeGallery);if(e.options.isOpen){e.openGallery();}return e;};a.defaults("up.PortalGallery",{isOpen:false,openSpeed:500,closeSpeed:50,browseContentPane:{type:"up.BrowseContentPane"},useContentPane:{type:"up.PortalGalleryPane",options:{key:"use-content",selectors:{pane:".use-content",paneLink:".use-content-link"},listeners:{onInitialize:null}}},skinPane:{type:"up.PortalGalleryPane",options:{key:"skin",selectors:{pane:".skins",paneLink:".skin-link"},listeners:{onInitialize:null}}},layoutPane:{type:"up.PortalGalleryPane",options:{key:"layout",selectors:{pane:".layouts",paneLink:".layout-link"},listeners:{onInitialize:function(c){up.LayoutSelector(".layouts-list",{});}}}},selectors:{menu:".menu",galleryInner:".gallery-inner",galleryHandle:".handle span",closeLink:".close-button",loading:".gallery-loader",ui:".content-wrapper .content"}});})(jQuery,fluid);
var up=up||{};(function(e,d){var g=function(j,h){var i=j.locate("permissionsDialog").find("form");i.find("[name=nodeId]").val(j.options.nodeIdExtractor(h));if(h.hasClass(j.options.cssClassNames.movable)){i.find("[name=movable]").attr("checked","checked");}else{i.find("[name=movable]").removeAttr("checked");}if(h.hasClass(j.options.cssClassNames.deletable)){i.find("[name=deletable]").attr("checked","checked");}else{i.find("[name=deletable]").removeAttr("checked");}if(h.hasClass(j.options.cssClassNames.editable)){i.find("[name=editable]").attr("checked","checked");}else{i.find("[name=editable]").removeAttr("checked");}if(h.hasClass(j.options.cssClassNames.addChildAllowed)){i.find("[name=addChildAllowed]").attr("checked","checked");}else{i.find("[name=addChildAllowed]").removeAttr("checked");}var k=j.options.titleExtractor(h);j.locate("formTitle").html(k);};var a=function(j,i){var h=b(j,j.locate("permissionsDialog").find("form")[0]);c(j,i,h);j.locate("permissionsDialog").dialog("close");j.events.onUpdatePermissions.fire(i,h);return false;};var b=function(j,i){var k={};k.elementID=e(i).find("[name=nodeId]").val();k.action="updatePermissions";k.deletable=e(i).find("[name=deletable]").attr("checked");k.movable=e(i).find("[name=movable]").attr("checked");if(e(i.edit)){k.editable=e(i).find("[name=editable]").attr("checked");}if(e(i.canAddChild)){k.addChildAllowed=e(i).find("[name=addChildAllowed]").attr("checked");}e.post(j.options.savePermissionsUrl,k,null,"json");var h={deletable:k.deletable,movable:k.movable,editable:k.editable,addChildAllowed:k.addChildAllowed};return h;};var c=function(j,h,i){f(h,i.deletable,j.options.cssClassNames.deletable);f(h,i.movable,j.options.cssClassNames.movable);f(h,i.editable,j.options.cssClassNames.editable);f(h,i.addChildAllowed,j.options.cssClassNames.addChildAllowed);};var f=function(i,h,j){if(h==undefined){return;}if(h){e(i).addClass(j);}else{e(i).removeClass(j);}};up.FragmentPermissionsMenu=function(h,i){var j=d.initView("up.FragmentPermissionsMenu",h,i);j.state={};j.refresh=function(l){var k=j.options.elementExtractor(j,l);g(j,k);j.locate("permissionsForm").unbind("submit").submit(function(){return a(j,k);});return false;};return j;};d.defaults("up.FragmentPermissionsMenu",{savePermissionsUrl:"mvc/layout",elementExtractor:null,titleExtractor:null,nodeIdExtractor:up.defaultNodeIdExtractor,cssClassNames:{movable:"movable",editable:"editable",deletable:"deletable",addChildAllowed:"canAddChildren"},selectors:{formTitle:null},events:{onUpdatePermissions:null},listeners:{onUpdatePermissions:null}});up.FragmentPermissionsManager=function(h,i){var j=d.initView("up.FragmentPermissionsManager",h,i);j.menus={};j.locate("pageDialog").dialog({width:550,modal:true,autoOpen:false});j.menus.pagePermissionsManager=up.FragmentPermissionsMenu(j.locate("pageDialog"),{savePermissionsUrl:j.options.savePermissionsUrl,elementExtractor:function(l,k){return e("#portalNavigationList li.active");},titleExtractor:function(k){return e("#portalNavigationList li.active a.portal-navigation-link").attr("title");},selectors:{formTitle:"h2"}});j.locate("pageDialogLink").click(function(){j.menus.pagePermissionsManager.refresh(e(this));j.locate("pageDialog").dialog("open");});j.locate("columnDialog").dialog({width:550,modal:true,autoOpen:false});j.menus.columnPermissionsManager=up.FragmentPermissionsMenu(j.locate("columnDialog"),{savePermissionsUrl:j.options.savePermissionsUrl,elementExtractor:function(l,k){return e(k).parents(".portal-page-column");},titleExtractor:function(k){return up.formatMessage(j.options.messages.columnX,[e(".portal-page-column").index(k)+1]);},selectors:{formTitle:"h2"}});j.locate("columnDialogLink").click(function(){j.menus.columnPermissionsManager.refresh(e(this));j.locate("columnDialog").dialog("open");});j.locate("portletDialog").dialog({width:550,modal:true,autoOpen:false});j.menus.portletPermissionsManager=up.FragmentPermissionsMenu(j.locate("portletDialog"),{savePermissionsUrl:j.options.savePermissionsUrl,elementExtractor:function(l,k){return e(k).parents(".up-portlet-wrapper");},titleExtractor:function(k){return k.find(".up-portlet-wrapper-inner h2 a").text();},selectors:{formTitle:"h2"},events:{onUpdatePermissions:null},listeners:{onUpdatePermissions:function(l,k){if(!k.movable){l.addClass("locked").removeClass("fl-reorderer-movable-default");l.find("[id*=toolbar_]").removeClass("ui-draggable");}else{l.removeClass("locked").addClass("fl-reorderer-movable-default");l.find("[id*=toolbar_]").addClass("ui-draggable");}}}});j.locate("portletDialogLink").click(function(){j.menus.portletPermissionsManager.refresh(e(this));j.locate("portletDialog").dialog("open");});return j;};d.defaults("up.FragmentPermissionsManager",{savePermissionsUrl:"mvc/layout",selectors:{formTitle:null,pageDialog:".edit-page-permissions-dialog",pageDialogLink:"#editPagePermissionsLink",columnDialog:".edit-column-permissions-dialog",columnDialogLink:".portal-column-permissions-link",portletDialog:".edit-portlet-permissions-dialog",portletDialogLink:".portlet-permissions-link"},messages:{columnX:"Column {0}"}});})(jQuery,fluid);
"use strict";var up=up||{};(function(c,b){var a=function(d){c.ajax({url:d.options.fragmentServiceUrl,async:false,success:function(e){d.state=d.state||{};d.state.fragments=e.fragments;c(d.state.fragments).each(function(f,g){d.state.fragments[g.owner]=g;});},dataType:"json"});};up.FragmentBrowser=function(d,f){var g=b.initView("up.FragmentBrowser",d,f);var e=[{id:"fragmentContainer:",selector:g.options.selectors.fragmentContainer},{id:"fragment",selector:g.options.selectors.fragment},{id:"fragmentTitle",selector:g.options.selectors.fragmentTitle},{id:"fragmentDescription",selector:g.options.selectors.fragmentDescription},{id:"selectFragmentLink",selector:g.options.selectors.selectFragmentLink}];a(g);g.refresh=function(){if(g.state.pager){g.state.pager.refresh(g.state.fragments);}else{var i=[{key:"fragment",valuebinding:"*.owner",components:function(j){return{decorators:[{type:"addClass",classes:j.subscribed?"fragment-disabled":""}]};}},{key:"fragmentTitle",valuebinding:"*.name"},{key:"fragmentDescription",valuebinding:"*.description"},{key:"selectFragmentLink",valuebinding:"*.owner",components:function(j){return{decorators:[{type:"jQuery",func:"click",args:function(){g.events.onFragmentSelect.fire(g,j);}}]};}}];var h={dataModel:g.state.fragments,annotateColumnRange:"fragmentTitle",columnDefs:i,bodyRenderer:{type:"fluid.pager.selfRender",options:{selectors:{root:g.options.selectors.pagerRoot},row:"fragmentContainer:",renderOptions:{cutpoints:e}}},pagerBar:{type:"fluid.pager.pagerBar",options:{pageList:{type:"fluid.pager.renderedPageList",options:{linkBody:"a"}}}}};g.state.pager=b.pager(c(d).find(".package-results"),h);g.state.pager.events.initiatePageSizeChange.fire(6);}};g.refresh();g.events.onLoad.fire(g);return g;};b.defaults("up.FragmentBrowser",{fragmentServiceUrl:null,selectors:{fragmentContainer:".package",fragment:".package-wrapper",fragmentTitle:".package-titlebar",fragmentDescription:".package-description",selectFragmentLink:".package-link",pagerRoot:".package-list"},events:{onFragmentSelect:null,onLoad:null},listeners:{onFragmentSelect:null,onLoad:null}});})(jQuery,fluid);
"use strict";var up=up||{};(function(c,b){var a=function(f){var e,d;e=f.options.currentLayout.join("-");d={children:[]};c(f.options.layouts).each(function(g,i){var h,j;j=i.columns.join("-");h="";if(i.columns.join("-")===e){h+="selected";}if(i.disabled){h+=" disabled";}d.children.push({ID:"layoutContainer:",children:[{ID:"layout",decorators:[{type:"addClass",classes:h}]},{ID:"layoutLink",decorators:[{type:"jQuery",func:"click",args:function(){f.options.currentLayout=i.columns;f.refresh();f.events.onLayoutSelect.fire(i,f);}}]},{ID:"layoutTitle",value:i.columns.length+" "+f.options.strings[i.columns.length==1?"column":"columns"]},{ID:"layoutDescription",value:f.options.strings[i.nameKey]},{ID:"layoutThumb",decorators:[{type:"attrs",attributes:{style:"background: url("+f.options.imagePath+"layout_"+j+".gif) top left no-repeat;"}}]}]});});return d;};up.LayoutSelector=function(d,f){var g,e;g=b.initView("up.LayoutSelector",d,f);e=[{id:"layoutContainer:",selector:g.options.selectors.layoutContainer},{id:"layout",selector:g.options.selectors.layout},{id:"layoutLink",selector:g.options.selectors.layoutLink},{id:"layoutTitle",selector:g.options.selectors.layoutTitle},{id:"layoutDescription",selector:g.options.selectors.layoutDescription},{id:"layoutThumb",selector:g.options.selectors.layoutThumb}];g.refresh=function(){var h=a(g);b.reRender(g.templates,c(d),h,{cutpoints:e});};g.templates=b.selfRender(c(d),a(g),{cutpoints:e});return g;};b.defaults("up.LayoutSelector",{currentLayout:[50,50],strings:{fullWidth:"Full-width",narrowWide:"Narrow, wide",even:"Even",wideNarrow:"Wide, narrow",narrowWideNarrow:"Narrow, wide, narrow",column:"Column",columns:"Columns"},layouts:[{nameKey:"fullWidth",columns:[100]},{nameKey:"narrowWide",columns:[40,60]},{nameKey:"even",columns:[50,50]},{nameKey:"wideNarrow",columns:[60,40]},{nameKey:"even",columns:[33,34,33]},{nameKey:"narrowWideNarrow",columns:[25,50,25]},{nameKey:"even",columns:[25,25,25,25]}],imagePath:"test/",selectors:{layoutContainer:".layout",layout:".layout-wrapper",layoutLink:".layout-link",layoutTitle:".layout-titlebar",layoutDescription:".layout-description",layoutThumb:".layout-thumb"},events:{onLayoutSelect:null},listeners:{onLayoutSelect:null}});})(jQuery,fluid);
"use strict";var up=up||{};(function(d,e){var a=function(l,j,m,k){return{key:l,name:j,description:m,thumbnailPath:k,thumbnailAlt:(j+" Thumbnail")};};var b=function(j){return[{id:"listItem-row:",selector:j.options.selectors.listItem},{id:"skinWrapper",selector:j.options.selectors.skinWrapper},{id:"skinLink",selector:j.options.selectors.skinLink},{id:"skinName",selector:j.options.selectors.skinName},{id:"skinThumbnail",selector:j.options.selectors.skinThumbnail}];};var f=function(k){var l,j;l=[];j=e.transform(k.state.model,function(n,m){return{ID:"listItem-row:",children:[{ID:"skinWrapper",decorators:[{type:"addClass",classes:n.key===k.options.currentSkin?k.options.activeSkin:""}]},{ID:"skinLink",decorators:[{type:"jQuery",func:"click",args:function(){var p,o,q;p=k.locate("skinList");p.find("."+k.options.activeSkin).removeClass(k.options.activeSkin);o=d(this);o.addClass(k.options.activeSkin);k.events.onSelectSkin.fire(n);}}]},{ID:"skinName",value:n.name,decorators:[{type:"attrs",attributes:{title:n.name}}]},{ID:"skinThumbnail",decorators:[{type:"attrs",attributes:{style:"background: url("+n.thumbnailPath+") top left no-repeat;"}}]}]};});return l.concat(j);};var h=function(j){return{children:f(j)};};var g=function(l){var k,j;k=l.locate("skinList");j={cutpoints:b(l),model:l.state.model,autoBind:true};l.state.templates=e.selfRender(k,h(l),j);k.find('input[value="'+l.options.currentSkin+'"]').parents(".widget").addClass(l.options.activeSkin);};var i=function(j){d.ajax({url:j.options.skinListURL,async:true,dataType:"xml",type:"GET",success:function(m){var l,k,n;l=d(m);k=l.find("skin");n=j.locate("skinList");d.each(k,function(o,u){var t,r,p,s,q;t=d(u);r=t.children("skin-key").text();p=t.children("skin-name").text();s=t.children("skin-description").text();q=(j.options.mediaPath+"/"+r+"/thumb.gif");j.state.model.push(a(r,p,s,q));});g(j);},error:function(k,m,l){if(console){console.log("AJAX Failure: ",k,m,l);}}});};var c=function(k){var j;k.state={};k.state.model=[];i(k);};up.SkinSelector=function(j,k){var l;l=e.initView("up.SkinSelector",j,k);l.refresh=function(){var m;m={cutpoints:b(l),model:l.state.model,autoBind:true};e.reRender(l.state.templates,l.locate("skinList"),h(l),m);};c(l);return l;};e.defaults("up.SkinSelector",{selectors:{skinList:".skins-list",listItem:".skin",skinWrapper:".skins-wrapper",skinLink:".skin-link",skinName:".skin-titlebar",skinThumbnail:".skin-thumb"},events:{onSelectSkin:null},currentSkin:null,skinListURL:null,mediaPath:null,activeSkin:"selected"});})(jQuery,fluid);
"use strict";var up=up||{};(function(g,e){var d=function(l){var k,i,m,j,o,n;k=l.locate("edit");i=l.locate("remove");j=l.locate("grabHandle");if(k.length>0){l.inlineEditor=e.inlineEdits(l.container,{selectors:{text:l.options.selectors.text,edit:l.options.selectors.edit},listeners:{afterBeginEdit:function(){i.hide();j.hide();},afterFinishEdit:function(s,q,r,p){i.show();j.filter(".active").show();l.events.onTabEdit.fire(s,q,r,p);}},submitOnEnter:l.options.submitOnEnter});m=l.locate("text");m.bind("mouseenter",function(){m.css("cursor","text");m.focus();});m.bind("mouseleave",function(){m.css("cursor","pointer");m.blur();});n=parseInt(l.options.numberOfPortlets);if(n===0&&m.text()===l.options.addTabLabel){m.trigger("click");}}};var f=function(j){var i;i=j.locate("remove");i.bind("click",function(){j.events.onTabRemove.fire(this);});};var c=function(j){var k,i;k=j.locate("add");i=j.container.find(j.options.selectors.tabGroup).text();k.bind("click",function(){j.events.onTabAdd.fire(j.options.addTabLabel,j.options.addTabWidths,i);});};var b=function(i){i.reorderLayout=e.reorderLayout(i.container,{selectors:{columns:i.options.selectors.columns,modules:i.options.selectors.modules,lockedModules:i.options.selectors.lockedModules,grabHandle:(i.options.tabContext==="header")?i.options.selectors.grabHandle:""},styles:{defaultStyle:"fl-reorderer-"+i.options.tabContext+"-movable-default",selected:"fl-reorderer-"+i.options.tabContext+"-movable-selected",dragging:"fl-reorderer-"+i.options.tabContext+"-movable-dragging",mouseDrag:"fl-reorderer-"+i.options.tabContext+"-movable-dragging",hover:"fl-reorderer-"+i.options.tabContext+"-movable-hover",dropMarker:"fl-reorderer-"+i.options.tabContext+"-dropMarker",avatar:"fl-reorderer-"+i.options.tabContext+"-avatar"},listeners:{afterMove:function(s,q,k){var m,l,j,p,o,r,n;m=g(s);l=up.defaultNodeIdExtractor(m);j=i.options.insertBefore;p=null;o=null;r=1;n=i.locate("tabListItems");if(m.is(":last-child")){j=i.options.appendAfter;p=m.prev();o=m.prev().attr("id").split("_")[1];}else{p=m.next();o=m.next().attr("id").split("_")[1];}g.each(n,function(u,v){var t=g(v);if(t.attr("id")===m.attr("id")){r=(u+1);}if(n.length===1){t.removeClass(i.options.styles.firstTab).removeClass(i.options.styles.lastTab).addClass(i.options.styles.singleTab);}else{if(u===0){t.removeClass(i.options.styles.singleTab).removeClass(i.options.styles.lastTab).addClass(i.options.styles.firstTab);}else{if(u===(n.length-1)){t.removeClass(i.options.styles.singleTab).removeClass(i.options.styles.firstTab).addClass(i.options.styles.lastTab);}else{t.removeClass(i.options.styles.singleTab).removeClass(i.options.styles.lastTab).removeClass(i.options.styles.firstTab);}}}});i.events.onTabMove.fire(l,j,o,r);}}});};var h=function(k){var j,i;j=k.locate("tabList");i=j.find(k.options.selectors.lockedModules+":last");if(i.length>0){i.find(k.options.selectors.grabHandle).hide();i.prevAll().addClass(k.options.styles.lockedTab).find(k.options.selectors.grabHandle).hide();}b(k);};var a=function(i){d(i);f(i);c(i);h(i);};up.TabManager=function(i,j){var k;k=e.initView("up.TabManager",i,j);a(k);return k;};e.defaults("up.TabManager",{selectors:{text:".flc-inlineEdit-text",edit:".flc-inlineEditable",remove:".portal-navigation-delete",add:".portal-navigation-add",columns:".flc-reorderer-column",modules:".movable",lockedModules:".locked",grabHandle:".portal-navigation-gripper",tabList:"#portalNavigationList",tabListItems:".portal-navigation",tabGroup:"#activeTabGroup"},events:{onTabEdit:null,onTabRemove:null,onTabAdd:null,onTabMove:null},styles:{lockedTab:"locked",singleTab:"single",firstTab:"first",lastTab:"last"},addTabLabel:"My Tab",addTabWidths:[50,50],insertBefore:"insertBefore",appendAfter:"appendAfter",tabContext:"header",numberOfPortlets:0,submitOnEnter:true});})(jQuery,fluid);
var up=up||{};(function(b,a){up.LayoutPreferencesPersistence=function(c,d){var e=a.initView("up.LayoutPreferencesPersistence",c,d);e.update=function(f,g){b.ajax({url:e.options.saveLayoutUrl,type:"POST",data:f,dataType:"json",async:false,success:g,error:function(i,j,h){e.events.onError.fire(e,i,j,h);}});};return e;};a.defaults("up.LayoutPreferencesPersistence",{saveLayoutUrl:null,selectors:{errorMessage:".layout-persistence-error-message"},messages:{error:"Error persisting layout change"},events:{onSuccess:null,onError:null},listeners:{onSuccess:null,onError:function(e,d,f,c){if(console){console.log(d,f,c);}e.locate("errorMessage").text(e.options.messages.error);}}});})(jQuery,fluid);
var uportal=uportal||{};(function(b,a){up.UrlProvider=function(c,d){var e=a.initView("up.UrlProvider",c,d);e.getPortletUrl=function(f){return e.options.portalContext+"/p/"+f;};e.getTabUrl=function(f){return e.options.portalContext+"/f/"+f;};e.getPortalHomeUrl=function(){return e.options.portalContext+"/";};return e;};a.defaults("up.UrlProvider",{portalContext:"/uPortal"});})(jQuery,fluid);
var uportal=uportal||{};(function(g,f){var h=[{nameKey:"fullWidth",columns:[100]},{nameKey:"narrowWide",columns:[40,60]},{nameKey:"even",columns:[50,50]},{nameKey:"wideNarrow",columns:[60,40]},{nameKey:"even",columns:[33,34,33]},{nameKey:"narrowWideNarrow",columns:[25,50,25]},{nameKey:"even",columns:[25,25,25,25]}];var b=function(){return up.defaultNodeIdExtractor(g("#portalNavigationList li.active"));};var a=function(){var i=[];g("#portalPageBodyColumns > [id^=column_]").each(function(){var j=g(this).get(0).className.match("fl-container-flex[0-9]+");if(j!=null){i.push(Number(j[0].match("[0-9]+")[0]));}});if(i.length==0){i.push(100);}return i;};var e=function(){var j=g("#portalPageBodyColumns > [id^=column_]");var l=j.filter(".deletable:not(:has(.locked))");var k=l.filter(":has(.up-portlet-wrapper)");if(k.size()>0){var i=j.filter(".canAddChildren");if(i.size()==0){l=l.filter(":not(:has(.up-portlet-wrapper))");}}return l;};var d=function(){var q=g("#portalFlyoutNavigation_"+b()).hasClass("canAddChildren");var k=g("#portalPageBodyColumns > [id^=column_]");var n=k.filter(".deletable:not(:has(.locked))");var m=k.length-n.length;var o=n.filter(":has(.up-portlet-wrapper)");if(o.size()>0){var j=k.filter(".canAddChildren");if(j.size()==0){n=n.filter(":not(:has(.up-portlet-wrapper))");m=k.length-n.length;}else{var p=false;for(var l=0;l<j.length;l++){if(g.inArray(j[l],n)<0){p=true;break;}}if(!p){m++;}}}var r=h.slice();g(r).each(function(i,s){if((!q&&s.columns.length>k.length)||(s.columns.length<m)){s.disabled=true;}});return r;};var c=function(o,p){var s=o.columns;var q=g("#portalPageBodyColumns [id^=column_]").size();var t={action:"changeColumns",tabId:b(),widths:s};if(s.length<q){var r=q-s.length;var j=e();t.deleted=[];var n=[];for(var l=0;l<r;l++){n.push(j[j.length-l-1]);t.deleted.push(up.defaultNodeIdExtractor(j[j.length-l-1]));}var m=g("#portalPageBodyColumns > [id^=column_].canAddChildren");var k=m.filter(":first");t.acceptor=up.defaultNodeIdExtractor(k);}p.persistence.update(t,function(i){g(i.newColumnIds).each(function(){var u=this;g("#portalPageBodyColumns").append(g(document.createElement("div")).attr("id","column_"+u).addClass("portal-page-column movable deletable editable canAddChildren").html('<div id="inner-column_'+u+'" class="portal-page-column-inner"></div>'));});g(n).each(function(u,v){g(this).find("div[id*=portlet_]").each(function(w,x){g(x).appendTo(k);});g(this).remove();});g("#portalPageBodyColumns > [id^=column_]").each(function(v){var w=g(this).removeClass("single left right");g(this.className.split(" ")).each(function(x,y){if(y.match("fl-container-flex")){g(w).removeClass(y);}});var u="fl-container-flex"+s[v];if(s.length==1){u+=" single";}else{if(v==0){u+=" left";}else{if(v==s.length-1){u+=" right";}else{u+=" middle";}}}g(w).addClass(u);});g("#portalPageBodyColumns").attr("class","columns-"+s.length);p.components.portletReorderer.refresh();});};up.LayoutPreferences=function(i,j){var k=f.initView("up.LayoutPreferences",i,j);k.persistence=up.LayoutPreferencesPersistence(i,{saveLayoutUrl:k.options.layoutPersistenceUrl,messages:{error:k.options.messages.persistenceError}});k.urlProvider=up.UrlProvider(i,{portalContext:k.options.portalContext});k.components={};k.components.gallery=up.PortalGallery(".up-gallery",{browseContentPane:{options:{portletBrowser:{options:{portletRegistry:{options:{portletListUrl:k.options.channelRegistryUrl}},listeners:{onPortletSelect:function(m,o){var l,n;l={action:"addPortlet",channelID:o.id};n=g("div[id*=portlet_].movable:first");if(n.size()==0){l.elementID=b();}else{l.elementID=up.defaultNodeIdExtractor(n);l.position="insertBefore";}k.persistence.update(l,function(p){window.location=k.urlProvider.getTabUrl(b());});},onPortletDrag:function(m,n,l){k.persistence.update({action:"addPortlet",channelID:m.id,position:n,elementID:l},function(o){window.location=k.urlProvider.getTabUrl(b());});}}}},fragmentBrowser:{options:{fragmentServiceUrl:k.options.subscribableTabUrl,listeners:{onFragmentSelect:function(o,n){var l,m;l=g("[id*=portalNavigation_]:last");m=up.defaultNodeIdExtractor(l);k.persistence.update({action:"subscribeToTab",sourceID:n.ownerID,method:"appendAfter",elementID:m},function(p){window.location=k.urlProvider.getTabUrl(p.tabId);});}}}}}},useContentPane:{options:{listeners:{onInitialize:function(l){up.PortletBrowser(".use-content",l,{portletRegistry:{options:{portletListUrl:k.options.channelRegistryUrl}},categoryListView:{type:"up.AjaxLayoutCategoryListView"},portletListView:{type:"up.AjaxLayoutPortletListView"},listeners:{onPortletSelect:function(m,n){window.location=k.urlProvider.getPortletUrl(n.fname);}}});}}}},skinPane:{options:{listeners:{onInitialize:function(l){up.SkinSelector(".skins",{listeners:{onSelectSkin:function(m){k.persistence.update({action:"chooseSkin",skinName:m.key},function(n){window.location=k.urlProvider.getTabUrl(b());});}},currentSkin:k.options.currentSkin,skinListURL:(k.options.mediaPath+"/skinList.xml"),mediaPath:k.options.mediaPath});}}}},layoutPane:{options:{listeners:{onInitialize:function(l){up.LayoutSelector(".layouts-list",{currentLayout:a(),layouts:d(),imagePath:k.options.mediaPath+"/common/images/",listeners:{onLayoutSelect:function(n,m){c(n,k);}},strings:k.options.messages});}}}}});k.components.tabManager=up.TabManager("#portalNavigation",{listeners:{onTabEdit:function(o,m,n,l){k.persistence.update({action:"renameTab",tabId:b(),tabName:o});},onTabRemove:function(m){if(!confirm(k.options.messages.confirmRemoveTab)){return false;}var l,n;l=m.parentNode;n=up.defaultNodeIdExtractor(l);k.persistence.update({action:"removeElement",elementID:n},function(o){window.location=k.urlProvider.getPortalHomeUrl();});},onTabAdd:function(l,m,n){k.persistence.update({action:"addTab",tabName:l,widths:m,tabGroup:n},function(o){window.location=k.urlProvider.getTabUrl(o.tabId);});},onTabMove:function(n,o,m,l){k.persistence.update({action:"moveTab",sourceID:n,method:o,elementID:m,tabPosition:l});}},tabContext:k.options.tabContext,numberOfPortlets:k.options.numberOfPortlets,addTabLabel:k.options.messages.addTabLabel});k.components.portletReorderer=up.fluid.reorderLayout("#portalPageBodyColumns",{selectors:{columns:".portal-page-column-inner",modules:".up-portlet-wrapper",lockedModules:".locked",dropWarning:g("#portalDropWarning"),grabHandle:"[id*=toolbar_]"},listeners:{afterMove:function(m){var o="insertBefore";var n=null;if(g(m).nextAll("div[id*=portlet_]").size()>0){n=g(m).nextAll("div[id*=portlet_]").get(0);}else{if(g(m).prevAll("div[id*=portlet_]").size()>0){n=g(m).prevAll("div[id*=portlet_]").get(0);o="appendAfter";}else{n=g(m).parent();}}var l=g("#portalPageBodyColumns > [id^=column_]");k.persistence.update({action:"movePortlet",method:o,elementID:up.defaultNodeIdExtractor(n),sourceID:up.defaultNodeIdExtractor(m)});}},styles:{mouseDrag:"fl-reorderer-movable-dragging-mouse"}});g("a[id*=removePortlet_]").click(function(){var l=up.defaultNodeIdExtractor(this);if(!confirm(k.options.messages.confirmRemovePortlet)){return false;}g("#portlet_"+l).remove();g("#portalSubnavLink_"+l).remove();k.persistence.update({action:"removeElement",elementID:l});return false;});return k;};f.defaults("up.LayoutPreferences",{tabContext:"header",numberOfPortlets:0,portalContext:"/uPortal",layoutPersistenceUrl:"/uPortal/api/layout",channelRegistryUrl:"/uPortal/api/portletList",subscribableTabUrl:"/uPortal/api/subscribableTabs.json",mediaPath:null,currentSkin:null,isFragmentMode:false,messages:{persistenceError:"Error persisting layout change"}});up.FocusedLayoutPreferences=function(i,j){var k=f.initView("up.FocusedLayoutPreferences",i,j);k.persistence=up.LayoutPreferencesPersistence(i,{saveLayoutUrl:k.options.layoutPersistenceUrl,messages:{error:k.options.messages.persistenceError}});k.urlProvider=up.UrlProvider(i,{portalContext:k.options.portalContext});k.components={};g("#focusedContentDialogLink").click(function(){g(".focused-content-dialog").dialog({width:500,modal:true});g(".focused-content-dialog form").submit(function(){var m,l,n;n=this;m=n.portletId.value;l=g(n).find("[name=targetTab]:checked").val();k.persistence.update({action:"addPortlet",channelID:m,position:"insertBefore",elementID:l},function(o){window.location=k.urlProvider.getTabUrl(l);});return false;});g(this).unbind("click").click(function(){g(".focused-content-dialog").dialog("open");});});return k;};f.defaults("up.FocusedLayoutPreferences",{portalContext:"/uPortal",layoutPersistenceUrl:"/uPortal/api/layout",messages:{persistenceError:"Error persisting layout change"}});})(jQuery,fluid);
"use strict";var up=up||{};(function(b,a){up.Autocomplete=function(c,e){var f=a.initView("up.Autocomplete",c,e);f.state=f.state||{};var d=[{id:"match:",selector:f.options.selectors.match},{id:"matchLink",selector:f.options.selectors.matchLink},{id:"matchText",selector:f.options.selectors.matchText}];f.search=function(){f.locate("dropdown").show();var h=f.options.searchFunction(f.locate("input").val());var g={children:[]};b(h).each(function(j,i){g.children.push({ID:"match:",children:[{ID:"matchLink",decorators:[{type:"jQuery",func:"click",args:function(){f.locate("input").val(i.text);f.state.currentValue=i.value;f.locate("dropdown").hide();}}]},{ID:"matchText",value:i.text}]});});if(f.state.templates){a.reRender(f.state.templates,f.locate("matches"),g,{cutpoints:d});}else{f.state.templates=a.selfRender(f.locate("matches"),g,{cutpoints:d});}f.locate("loadingMessage").hide();};f.getValue=function(){return f.state.currentValue;};f.locate("close").click(function(){f.locate("dropdown").hide();});f.locate("input").keyup(f.search);f.locate("input").focus(function(){var g=f.locate("input").val();if(g==f.options.initialText){f.locate("input").val("");}});f.locate("input").blur(function(){var g=f.locate("input").val();if(g==""){f.locate("input").val(f.options.initialText);}});return f;};a.defaults("up.Autocomplete",{initialText:"",searchFunction:null,selectors:{input:".up-autocomplete-searchterm",dropdown:".up-autocomplete-dropdown",close:".up-autocomplete-close",noResultsMessage:".up-autocomplete-noresults",matches:".up-autocomplete-matches",match:".up-autocomplete-match",matchLink:".up-autocomplete-match-link",matchText:".up-autocomplete-match-text",loadingMessage:".up-autocomplete-loading"},events:{onSearch:null,onClose:null},listeners:{onSearch:null,onClose:null}});})(jQuery,fluid);
var up=up||{};(function(c,b){var d=function(e){c(e.locate("stacktracediv")).hide();};var a=function(h){var e=c(h.locate("stacktracetoggle"));var i=c(h.locate("stacktracediv"));var f=h.options.hidemessage;var g=h.options.showmessage;e.toggle(function(){i.show("fast",function(){e.text(f);});},function(){i.hide("fast",function(){e.text(g);});});};up.showHideToggle=function(e,f){var g=b.initView("up.showHideToggle",e,f);d(g);a(g);return g;};b.defaults("up.showHideToggle",{showmessage:"Show Stack Trace",hidemessage:"Hide Stack Trace",selectors:{stacktracediv:".stacktrace",stacktracetoggle:".stacktracetoggle"}});})(jQuery,fluid);
"use strict";var up=up||{};(function(e,i){var f=function(r){var s=r.indexOf(":");return r.substring(0,s);};var g=function(r){var s=r.indexOf(":");return r.substring(s+1,r.length);};var d=function(u,s,t){var r;switch(t){case false:r='<span class="selection" title="'+u.options.messages.nothingSelected+'">'+u.options.messages.nothingSelected+"</span>";break;case true:r='<a href="javascript:;" title="'+u.options.messages.removeSelection+'" key="'+s.entityType+":"+s.id+'" class="'+u.options.styles.selection+'">'+s.name+'</a><input type="hidden" name="groups" value="'+s.entityType+":"+s.id+'"/>';break;}return r;};var n=function(w,s,u){var t,y,x,v,r;t=w.locate("currentEntityName");y=t.attr("key");x=w.locate("entityBrowserTitlebar");v=w.locate("selectEntityLink");v.unbind("click");r=w.registry.getEntity(f(s),g(s));if(e.inArray(y,w.options.selected)<0){x.removeClass(w.options.styles.selected);}else{x.addClass(w.options.styles.selected);}if(!u){v.bind("click",function(z){b(w,w.currentEntity.entityType+":"+w.currentEntity.id);});v.attr("title",w.currentEntity.name);}else{v.bind("click",function(z){p(w,w.currentEntity.entityType+":"+w.currentEntity.id);});v.attr("title",w.currentEntity.name);}};var p=function(v,t){var w,s,r,u;w=v.locate("selectionBasket");r=v.locate("buttonPrimary");s=v.registry.getEntity(f(t),g(t));u=[];switch(v.selectMultiple){case false:v.options.selected=[];w.html(d(v,s,false));break;case true:w.find("a").each(function(){var x=e(this);if(x.attr("key")!==t){u.push(x.attr("key"));}else{x.parent().remove();}});v.options.selected=u;break;}if(t===(v.currentEntity.entityType+":"+v.currentEntity.id)){n(v,t,false);}else{n(v,t,true);}if(v.options.selected.length<1){r.attr("disabled","disabled");}};var b=function(v,u){var w,s,r,t;w=v.locate("selectionBasket");s=v.locate("buttonPrimary");t=v.registry.getEntity(f(u),g(u));switch(v.selectMultiple){case false:v.options.selected=[];v.options.selected.push(u);w.html(d(v,t,true));break;case true:if(e.inArray(u,v.options.selected)<0){v.options.selected.push(u);r=e('<li><a href="javascript:;" key="'+t.entityType+":"+t.id+'">'+t.name+'</a><input type="hidden" name="groups" value="'+t.entityType+":"+t.id+'"/></li>');w.find("ul").append(r);r.find("a").click(function(){p(v,e(this).attr("key"));});}break;}if(u===(v.currentEntity.entityType+":"+v.currentEntity.id)){n(v,u,true);}else{n(v,u,false);}s.removeAttr("disabled");};var m=function(u,s){var r,t;r=s.parent();t=r.nextAll();t.remove();l(u,s.attr("key"));};var k=function(u,t,s,r){var v;v='<span><a href="javascript:;" title="'+s+'" key="'+t+'">'+s+"</a> &gt; </span>";r.append(v);r.find("a").unbind("click").click(function(){m(u,e(this));});};var o=function(u,s){var r,t,v;r=u.locate("breadcrumbs");t=s.entityType+":"+s.id;if(r.find("span").length>0){v=(r.find('span a[key="'+t+'"]').length>0)?true:false;if(!v){k(u,t,s.name,r);}}else{k(u,t,s.name,r);}r.find("."+u.options.styles.last).removeClass(u.options.styles.last).css("visibility","visible");r.find("span:last").addClass(u.options.styles.last).css("visibility","hidden");};var l=function(v,s){var r,t,u,w,x,y;r=v.registry.getEntity(f(s),g(s));v.currentEntity=r;t=v.locate("currentEntityName");u=v.locate("browsingInclude");w=v.locate("entityBrowserContent");x=w.find("."+v.options.styles.memberList);y=v.locate("browsingResultNoMembers");o(v,r);t.text(r.name);t.attr("key",r.entityType+":"+r.id);u.text(r.name);x.html("").hide();e.each(r.children,function(A,C){var z,B;z='<li class="'+C.entityType+'"><a href="javascript:;"><span class="'+v.options.styles.memberLink+'" key="'+C.entityType+":"+C.id+'">'+C.name+"</span></a></li>";B=w.find("."+C.entityType.toLowerCase()).find("."+v.options.styles.memberList);B.append(z);B.show();});w.find("a").click(function(){l(v,e(this).find("span").attr("key"));});y.css("display",w.find("."+v.options.styles.memberList).find("li").size()>0?"none":"block");n(v,s,e.inArray(s,v.options.selected)>=0);};var a=function(r){var s;s=r.searchDropDown.find(r.options.selectors.searchResults);s.find("."+r.options.styles.selected).removeClass(r.options.styles.selected);e.each(r.options.selected,function(t,v){var u=s.find('span[key="'+v+'"]');u.parent().parent().addClass(r.options.styles.selected);});};var h=function(t,s){var r=t.registry.getEntity(f(s),g(s));if(e.inArray(s,t.options.selected)!==-1){p(t,r.entityType+":"+r.id);}else{b(t,r.entityType+":"+r.id);}a(t);};var q=function(w,t,v){var y,x,u,s,r;if(t===w.options.messages.searchValue){t="";}y=w.registry.searchEntities(w.options.entityTypes,t);x=w.searchDropDown.find(w.options.selectors.searchResults);s=w.locate("searchResultsNoMembers");x.html("");u="";e.each(y,function(z,A){u+='<li class="'+A.entityType+'"><a href="javascript:;" title="'+A.name+'"><span key="'+A.entityType+":"+A.id+'">'+A.name+"</span></a></li>";});x.html(u);x.find("a").bind("click",function(){var z=e(this).find("span");h(w,z.attr("key"));});r=x.find("li");if(r.length<1){s.show();x.hide();}else{x.show();s.hide();}a(w);return false;};var j=function(w){var s,v,u,x,t,r;v=w.locate("closeSearch");u=w.locate("searchForm");s=u.parent();x=u.find("input[type=text]");r=w.locate("searchLoader");t=w.locate("searchDropDown");x.val(w.options.messages.searchValue);t.css({top:x.outerHeight()});x.bind("click focus",function(){e(this).val("");});u.submit(function(){up.showLoader(r);q(w,x.val(),u);t.show();up.hideLoader(r);return false;});v.bind("click",function(){t.hide();});e(document).bind("click",function(y){if(w.isEmptyArray(e(y.target).parents("."+w.options.styles.search))){t.hide();}});};var c=function(r){j(r);r.locate("selectionBasket").find("a").click(function(){p(r,e(this).attr("key"));});l(r,r.options.initialFocusedEntity);if(r.options.selected.length<1&&r.options.requireSelection){r.locate("buttonPrimary").attr("disabled","disabled");}};up.entityselection=function(r,s){var t;t=i.initView("up.entityselection",r,s);t.selectMultiple=t.options.selectMultiple;t.searchDropDown=t.locate("searchDropDown");t.registry=i.initSubcomponent(t,"entityRegistry",[r,i.COMPONENT_OPTIONS]);t.isEmptyArray=function(u){return((u.length>0)?false:true);};c(t);return t;};i.defaults("up.entityselection",{entityRegistry:{type:"up.EntityRegistry"},entityTypes:[],selected:[],initialFocusedEntity:"group:local.0",selectMultiple:true,requireSelection:true,selectors:{selectionBasket:"#selectionBasket",breadcrumbs:"#entityBrowsingBreadcrumbs",currentEntityName:"#currentEntityName",selectEntityLink:"#selectEntityLink",entityBrowserContent:"#entityBrowserContent",entityBrowserTitlebar:"#entityBrowserTitlebar",browsingInclude:"#browsingInclude",browsingResultNoMembers:"#browsingResultNoMembers",closeSearch:"closeDropDown",searchForm:"#searchForm",searchDropDown:"#searchDropDown",searchResults:"#searchResults",searchResultsNoMembers:"#searchResultsNoMembers",searchLoader:"searchLoader",buttonPanel:"#buttonPanel",buttonPrimary:"#buttonPrimary"},styles:{memberList:"member-list",memberLink:"member-link",selection:"selection",selected:"selected",last:"last",title:"title",search:"portlet-search"},messages:{selectButtonMessage:"",deselectButtonMessage:"",removeCrumb:"",removeSelection:"",addSelection:"",selected:"",nothingSelected:"",searchValue:""}});})(jQuery,fluid);
var up=up||{};(function(d,f){var e=function(j,k){return k.options.parameterBindName+"['"+k.options.parameterNamePrefix+j+"'].value";};var b=function(j,k){return k.options.auxiliaryBindName+"['"+k.options.parameterNamePrefix+j+"'].value";};var h=function(m,l){var o,p,k,j,n;k=d(m).find("input[name=name]").val();j=b(k,l);o=d(document.createElement("tr"));o.append(d(document.createElement("td")).text(k));p=d(document.createElement("td"));o.append(p);if(l.options.multivalued){p.append(d(document.createElement("a")).attr("href","javascript:;").addClass(l.options.displayClasses.addValueLink).text(l.options.messages.addValue).attr("paramName",k).click(function(){a(d(this),l);}));a(p.find("."+l.options.displayClasses.addValueLink),l);}else{p.append(d(document.createElement("input")).attr("name",j));}if(l.options.useAuxiliaryCheckbox){n=d(document.createElement("input")).attr("type","checkbox").attr("name",b(k,l)).val("true");o.append(d(document.createElement("td")).append(n));}o.append(d(document.createElement("td")).append(d(document.createElement("a")).text(l.options.messages.remove).addClass(l.options.displayClasses.removeItemLink).attr("href","javascript:;").click(function(){g(d(this),l);})));l.locate("preferencesTable").append(o);l.options.dialog.dialog("close");return false;};var g=function(k,j){d(k).parent().parent().remove();};var a=function(l,k){var j,m;l=d(l);j=e(l.attr("paramName"),k);l.before(d(document.createElement("div")).append(d(document.createElement("input")).attr("name",j)).append(d(document.createElement("a")).attr("href","javascript:;").addClass(k.options.displayClasses.deleteValueLink).text(k.options.messages.remove).click(function(){c(d(this),k);})));};var c=function(k,j){d(k).parent().remove();};var i=function(k){var j=k.options.dialog;if(k.options.dialogInitialized){j.dialog("open");}else{j.find("form").submit(function(){return h(this,k);});j.dialog();k.options.dialogInitialized=true;}};up.ParameterEditor=function(j,k){var l=f.initView("up.ParameterEditor",j,k);j=d(j);j.find("."+l.options.displayClasses.deleteItemLink).click(function(){g(this,l);});j.find("."+l.options.displayClasses.deleteValueLink).click(function(){c(this,l);});j.find("."+l.options.displayClasses.addValueLink).click(function(){a(this,l);});j.find("."+l.options.displayClasses.addItemLink).click(function(){i(l);});l.options.dialogInitialized=false;};f.defaults("up.ParameterEditor",{parameterNamePrefix:"",parameterBindName:"",auxiliaryBindName:"",useAuxiliaryCheckbox:false,dialog:null,multivalued:false,displayClasses:{deleteItemLink:"delete-parameter-link",deleteValueLink:"delete-parameter-value-link",addItemLink:"add-parameter-link",addValueLink:"add-parameter-value-link"},messages:{remove:"Remove",addValue:"Add value"},selectors:{preferencesTable:"tbody"}});})(jQuery,fluid);
var uportal=uportal||{};(function(c,b){var d=function(e){a(e);c(e.container).mouseover(function(){var h,f,g,i,j;h=c(this);f=e.locate("flyoutMenu");g=e.locate("flyoutList");if(g.html()!==""){e.openFlyout();}if(e.options.orientation==="horizontal"){if(e.options.horzalign==="left"){j=0;}else{j=h.outerWidth()-f.outerWidth();}if(e.options.vertalign==="bottom"){i=(h.outerHeight()-e.options.offset);}else{i=f.outerHeight()*-1;}}else{if(e.options.horzalign==="left"){j=f.outerWidth()*-1;}else{j=h.outerWidth();}if(e.options.vertalign==="bottom"){i=0;}else{i=(f.outerHeight()-h.outerHeight())*-1;}}c(e.container).mouseout(function(){e.closeFlyout();});f.css({top:i,left:j}).bgiframe();});};var a=function(e){if(c.browser.msie){if(c.browser.version==="7.0"){e.locate("flyoutMenu").parents().each(function(){var f=c(this);var g=f.css("position");if(g=="relative"||g=="absolute"||g=="fixed"){c(this).addClass(e.options.styles.onTop);}});return;}}};uportal.flyoutmenu=function(e,f){var g=b.initView("uportal.flyoutmenu",e,f);d(g);g.openFlyout=function(){g.locate("flyoutMenu").show();};g.closeFlyout=function(){g.locate("flyoutMenu").hide();};};b.defaults("uportal.flyoutmenu",{orientation:"horizontal",horzalign:"left",vertalign:"bottom",offset:0,selectors:{flyoutMenu:".portal-flyout-container",flyoutList:".portal-subnav-list"},styles:{onTop:"on-top"}});})(jQuery,fluid);
"use strict";var up=up||{};(function(b,a){up.TranslatorPortlet=function(d,o){var j=a.initView("up.TranslatorPortlet",d,o);var h=null;var n=function(){j.options.entity=null;var r=[{ID:"code",value:""},{ID:"locale",value:j.options.locale},{ID:"value",value:""}];var p=[{selector:".uptrans-mfrm-code",id:"code"},{selector:".uptrans-mfrm-loc",id:"locale"},{selector:".uptrans-mfrm-value",id:"value"}];var q=j.locate("messageForm");q.find(".uptrans-mfrm-code-fieldset").show();a.selfRender(q.show(),r,{cutpoints:p});j.locate("portletForm").hide();j.locate("formContainer").show();};var m=function(){b.ajax({url:j.options.resourceUrl,dataType:"json",data:{action:"getEntity",id:j.options.entity.id,locale:j.options.locale,entity:j.options.entityType},success:function(r){var s=r.message;if(s==null){s={code:j.options.entity.id,locale:j.options.locale,value:""};}var t=[{ID:"code",value:s.code},{ID:"locale",value:s.locale},{ID:"value",value:s.value}];var p=[{selector:".uptrans-mfrm-code",id:"code"},{selector:".uptrans-mfrm-loc",id:"locale"},{selector:".uptrans-mfrm-value",id:"value"}];j.locate("portletForm").hide();j.locate("formContainer").show();var q=j.locate("messageForm");q.find(".uptrans-mfrm-code-fieldset").hide();a.selfRender(q.show(),t,{cutpoints:p});}});};var e=function(){var p=b(this);b.ajax({url:p.attr("action"),type:"POST",data:p.serialize(),success:function(){var q=j.locate("formContainer").find(".portlet-msg-success");q.html(j.options.messages.portletTranslationSaved);q.show();q.fadeOut(4000);}});return false;};var l=function(){b.ajax({url:j.options.resourceUrl,dataType:"json",data:{action:"getEntity",id:j.options.entity.id,locale:j.options.locale,entity:j.options.entityType},success:function(q){var s=q.portlet;var r=[{ID:"id",value:s.id},{ID:"locale",value:s.locale},{ID:"original.title",value:s.original.title},{ID:"localized.title",value:s.localized.title},{ID:"original.name",value:s.original.name},{ID:"localized.name",value:s.localized.name},{ID:"original.description",value:s.original.description},{ID:"localized.description",value:s.localized.description},];var p=[{selector:".uptrans-pfrm-id",id:"id"},{selector:".uptrans-pfrm-loc",id:"locale"},{selector:".uptrans-pfrm-loc-name",id:"localized.name"},{selector:".uptrans-pfrm-loc-title",id:"localized.title"},{selector:".uptrans-pfrm-loc-descr",id:"localized.description"},{selector:".uptrans-pfrm-orig-title",id:"original.title"},{selector:".uptrans-pfrm-orig-name",id:"original.name"},{selector:".uptrans-pfrm-orig-descr",id:"original.description"}];j.locate("messageForm").hide();j.locate("formContainer").show();a.selfRender(j.locate("portletForm").show(),r,{cutpoints:p});}});};var g=function(){if(j.options.entity){if(j.options.entityType=="portlet"){l();}else{if(j.options.entityType=="message"){m();}}}};var i=function(q){j.locate("formContainer").hide();if(j.options.entityType=="message"){j.locate("addMessage").show();}else{j.locate("addMessage").hide();}var r=[];b(q.entities.sort(up.getStringPropertySortFunction("title"))).each(function(s,t){r.push({ID:j.options.namespace+"data:",value:t.title,decorators:[{type:"jQuery",func:"click",args:function(){j.options.entity=t;g();}}]});});var p=[{selector:j.options.selectors.entityList,id:j.options.namespace+"data:"},{selector:j.options.selectors.entity,id:"name"}];if(h==null){h=a.selfRender(j.locate("entities"),r,{cutpoints:p});}else{a.reRender(h,j.locate("entities"),r,{cutpoints:p});}};var k=function(){var p=j.locate("entityType").val();j.options.entityType=j.locate("entityType").val();j.options.entity=null;if(p&&p!=""){b.ajax({url:j.options.resourceUrl,dataType:"json",data:{entity:p,action:"getEntityList"},success:i});}};var c=function(){var p=b(this);b.ajax({url:p.attr("action"),type:"POST",data:p.serialize(),success:function(r){if(j.options.entity==null){k();}var q=j.locate("formContainer").find(".portlet-msg-success");q.html(j.options.messages.messageTranslationSaved);q.show();q.fadeOut(4000);}});return false;};j.locate("entityType").change(k);j.locate("portletForm").submit(e);j.locate("messageForm").submit(c);j.locate("entityForm").submit(function(){return false;});j.locate("addMessage").click(n);var f=j.locate("locale");f.change(function(){j.options.locale=f.val();g();});j.options.locale=f.val();k();return j;};a.defaults("up.TranslatorPortlet",{namespace:"uptrans",locale:null,entityType:null,entity:null,resourceUrl:"",selectors:{entityForm:"#uptrans-form",locale:"#uptrans-locale",entityType:"#uptrans-entityType",entity:".uptrans-entity",entities:"#uptrans-entities",entityList:"#uptrans-entityList",portletForm:"#uptrans-portletForm",messageForm:"#uptrans-messageForm",formContainer:"#uptrans-formContainer",addMessage:"#uptrans-addMessage"},messages:{messageTranslationSaved:"Message translation has been succesfully saved",portletTranslationSaved:"Portlet definition translation has been successfully saved"}});})(jQuery,fluid);